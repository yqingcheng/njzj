<style lang="scss">
  /**indexDetail.wxss**/
  @font-face {
    font-family: "iconfont";
    src: url(data:application/x-font-woff;charset=utf-8;base64,d09GRgABAAAAAAUoAAsAAAAAB3AAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABHU1VCAAABCAAAADMAAABCsP6z7U9TLzIAAAE8AAAAQwAAAFZW8khtY21hcAAAAYAAAABeAAABhprQBr5nbHlmAAAB4AAAAU8AAAFYWWaCw2hlYWQAAAMwAAAAMQAAADYSJZC3aGhlYQAAA2QAAAAgAAAAJAg1A9dobXR4AAADhAAAAAwAAAAMDD///WxvY2EAAAOQAAAACAAAAAgAdgCsbWF4cAAAA5gAAAAfAAAAIAESAF1uYW1lAAADuAAAAUUAAAJtPlT+fXBvc3QAAAUAAAAAJQAAADbX3VfqeJxjYGRgYOBikGPQYWB0cfMJYeBgYGGAAJAMY05meiJQDMoDyrGAaQ4gZoOIAgCKIwNPAHicY2BkEWWcwMDKwMHUyXSGgYGhH0IzvmYwYuRgYGBiYGVmwAoC0lxTGBwYKp6lMTf8b2CIYW5gaAEKM4LkAOG+C/QAeJzFkMENgDAMAy9t6QMxCA8G4sWzM3TirlFMKA8mqCXHimMpUYAFiOIhJrAL48Ep19yPrO4nz2SpEait9K7+U0U0y65BJTMNNm/1H5vXfXT6CnVQJ7byknADVV4NJwAAeJwN0L9OwkAcwPH73XHXFtqe9GhLy3+wPQ1KYoUyiLi4aBxMdGGTB9DBhYWhi4mDg09AgjFx8REYdfIpjL4AD2Ar33ye4IsoQtk3WZEyEmgHHaBTdIkQsC60TVyDluz3cBfsFrXdkklkR7aUTrtHjsFts5ITxf3QZQrjYEIdDltRLHtYwqA/xkcQOTUAr+JfWUHVIs+QL8v6Q3qOX8BudKp8vJ+e7Z2UoqZQZ7pleZb1pDJKVYxz3IRb19GolmfpK+W+vWrs4gbonvQvJkazYk0f+3e1wNUAkgREpWm+nRT94sbcd4TlKVuGWvaNznYJZr+FstBr4Q/aBNlfNs9NSIIqCNG2DCgLh0KG8TAQceQKWgcOwlEYuWcs/Uw/TI+MskKew81CrSsLmHItn42wriRkuWRFDtfrQpVEMDCM9Csi1cI6fefaZin6B+Y3O9wAeJxjYGRgYADil96ufPH8Nl8ZuFkYQOB6hFo8jP7/938NSyRzA5DLwcAEEgUAImULAQAAAHicY2BkYGBu+N/AEMMS9v/v/78skQxAERTADACvWAcTBAAAAAPpAAAEVv/9AAAAAAB2AKx4nGNgZGBgYGYIZGBlAAEmIOYCQgaG/2A+AwAQ9wFwAHicZY9NTsMwEIVf+gekEqqoYIfkBWIBKP0Rq25YVGr3XXTfpk6bKokjx63UA3AejsAJOALcgDvwSCebNpbH37x5Y08A3OAHHo7fLfeRPVwyO3INF7gXrlN/EG6QX4SbaONVuEX9TdjHM6bCbXRheYPXuGL2hHdhDx18CNdwjU/hOvUv4Qb5W7iJO/wKt9Dx6sI+5l5XuI1HL/bHVi+cXqnlQcWhySKTOb+CmV7vkoWt0uqca1vEJlODoF9JU51pW91T7NdD5yIVWZOqCas6SYzKrdnq0AUb5/JRrxeJHoQm5Vhj/rbGAo5xBYUlDowxQhhkiMro6DtVZvSvsUPCXntWPc3ndFsU1P9zhQEC9M9cU7qy0nk6T4E9XxtSdXQrbsuelDSRXs1JErJCXta2VELqATZlV44RelzRiT8oZ0j/AAlabsgAAAB4nGNgYoAALgbsgJmRiZGZkYWBsYKjOCO/NDkxL52BAQAfZgP1AAAA) format('woff');
  }
  .iconfont {
    font-family: "iconfont" !important;
    font-size: 16px;
    font-style: normal;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }
  .icon-shoucang:before {
    content: "\e666";
  }
  page {
    font-size: 30rpx;
  }
  image {
    width: 100%;
  }
  .wrap {
    width: 99.9%;
    background-color: #F6F6F6;
  }
  .detail_tit {
    float: left;
    width: 90%;
    padding-left: 5%;
    padding-right: 5%;
    height: 60rpx;
    line-height: 70rpx;
    background-color: #fff;
    border-bottom: 1px solid #f6f6f6;
    overflow: hidden;
  }
  .txt-name1 {
    color: #2BCF86;
    padding-left: 5%;
    font-size: 30rpx;
    border-left: 1px solid #2BCF86;
  }
  .detail_top {
    width: 100%;
    display: flex;
  }
  .my_list {
    width: 100%;
    float: left;
    background-color: #fff;
  }
  .list_item {
    width: 90%;
    margin-left: 5%;
    float: left;
    margin-top: .5rem;
    margin-bottom: .5rem;
  }
  .list_item .li_left {
    width: 10%;
    float: left;
    margin-right: 5px;
  }
  .list_item .li_left image {
    width: 100%;
    height: 70rpx;
    border: 1px solid #f6f6f6;
    border-radius: 50%;
    -webkit-border-radius: 50%;
  }
  .list_item .li_right2 {
    width: 10%;
    float: right;
    margin-left: 5px;
  }
  .list_item .li_right2 image {
    width: 100%;
    height: 70rpx;
    border: 1px solid #f6f6f6;
    border-radius: 50%;
    -webkit-border-radius: 50%;
  }
  .list_item .li_right {
    width: 85%;
    float: right;
  }
  .list_item .li_right .wed {
    width: 80%;
    height: 8rem;
    background: no-repeat;
    background-position: center;
    background-size: cover;
    float: right;
  }
  .list_item .li_right .li_right_txt {
    width: 100%;
  }
  .list_item .li_right .li_right_txt .txt_name {
    font-size: 20rpx;
  }
  .list_item .li_right .li_right_txt .hui {
    color: #ccc;
  }
  .list_item .li_right .li_right_txt image {
    width: 31%;
    float: left;
    max-height: 150rpx;
    margin-right: 12rpx;
  }
  .z_pic {
    float: left;
    width: 90%;
    padding-left: 5%;
    padding-right: 5%;
    line-height: 70rpx;
    border-bottom: 1px solid #f6f6f6;
    background-color: #fff;
    margin-top: .5rem;
    padding-top: 25rpx;
  }
  .z_pic .z_tou {
    width: 30px;
    height: 30px;
    border-radius: 50%;
    -webkit-border-radius: 50%;
    float: left;
    margin-bottom: 20rpx;
  }
  .z_pic_right {
    float: left;
    width: 80%;
    height: 40px;
    line-height: 40px;
    margin-left: .5rem;
  }
  .z_pic_right .txt {
    margin-left: .5rem;
  }
  .blo_rap {
    width: 100%;
    height: 96rpx;
    float: left;
    background: white;
  }
  #shareBtn {
    width: 194rpx;
    height: 76rpx;
    line-height: 76rpx;
    position: fixed;
    bottom: 80px;
    right: 0rpx;
    text-align: center;
    background-color: #1fab39;
    color: #fff;
    font-size: 28rpx;
    display: inline-block;
    margin: 0;
    padding: 0;
    border-radius: 38px 0 0 38px;
  }
  #shareBtn::after {
    border: none !important;
  }
  .wrapmb {
    margin-bottom: 3.5rem;
  }
</style>

<template>
  <view class="wrap">
    <view class="detail_tit">
      <text class="txt-name1">问题内容</text>
    </view>
    <view class="my_list">
      <view class="list_item">
        <view class="li_left" style=" margin-top:10rpx;">
          <image src="{{question.askerUser.head_img}}"></image>
        </view>
        <view class="li_right">
          <view class="li_right_txt">
            <text class="txt-name">{{question.askerUser.name}}</text>
          </view>
          <view class="li_right_txt">
            <text class="txt-name hui">{{question.create_time}}</text>
            <text class="txt-name hui" style="float: right;">{{question.askerUser.location}}</text>
          </view>
          <view class="li_right_txt" style="margin-top:20rpx;">
            <text class="txt-name"> {{question.title}}</text>
          </view>
          <view class="li_right_txt" style="margin-top:20rpx;" wx:for="{{question.images}}" wx:for-index="idx" wx:for-item="imageItem" wx:key="idx">
            <image src="{{imageItem}}"></image>
          </view>
        </view>
      </view>
    </view>
    <view class="detail_tit" style="margin-top:.5rem;">
      <text class="txt-name1">专业解答</text>
    </view>
    <view class="my_list" wx:if="{{question.answer_num==0}}">
      <text class="txt-name" style="/*text-align: center*/width: 100%;text-align: center;display: block;padding: 8px; 0; 0;font-size:30rpx;">暂时没有回复哦！！！</text>
    </view>
    <view class="my_list">
      <block wx:for="{{question.answers}}" wx:for-item="questionItem" wx:key="idx">
        <view class="list_item">
          <block wx:if="{{questionItem.content_type==2}}">
            <block wx:if="{{questionItem.speaker_type==2}}">
              <!--问题图片-->
              <view class="li_right" style="width:50%; margin-top:10rpx;float:left">
                <!-- <image src="{{questionItem.content}}" data-src="{{questionItem.content}}" bindtap="previewImage"></image> -->
                <view class="wed" data-src="{{questionItem.content}}" bindtap="previewImage" style="background-image: url('{{questionItem.content}}')"></view>
              </view>
              <!--回答人头像-->
              <view class="li_left">
                <image src="{{question.answerUser.head_img}}"></image>
              </view>
            </block>
            <block wx:elif="{{questionItem.speaker_type==1}}">
              <!--提问人头像-->
              <view class="li_right2">
                <image src="{{question.askerUser.head_img}}"></image>
              </view>
              <view class="li_right" style=" margin-top:10rpx;float:right">
                <!-- <image src="{{questionItem.content}}" data-src="{{questionItem.content}}" bindtap="previewImage" style="float:right;border-radius:10rpx;"></image>  -->
                <view class="wed" data-src="{{questionItem.content}}" bindtap="previewImage" style="background-image: url('{{questionItem.content}}')"></view>
              </view>
            </block>
          </block>
          <block wx:elif="{{questionItem.content_type==1}}">
            <block wx:if="{{questionItem.speaker_type==1}}">
              <view class="li_right" style="float:left;margin-right:3%; ">
                <view class="li_right_txt" style=" text-align: right; ">
                  <text class="txt-name">{{questionItem.content}}</text>
                </view>
                <view class="li_right_txt">
                  <text class="txt-name hui" style="float: right;">{{questionItem.create_time}}</text>
                </view>
              </view>
              <!--提问人头像-->
              <view class="li_left" style="float:right;">
                <image src="{{question.askerUser.head_img}}"></image>
              </view>
            </block>
            <block wx:elif="{{questionItem.speaker_type==2}}">
              <!--回答人头像-->
              <view class="li_left">
                <image src="{{question.answerUser.head_img}}"></image>
              </view>
              <!--问题文字-->
              <view class="li_right">
                <view class="li_right_txt">
                  <text class="txt-name">{{questionItem.content}}</text>
                </view>
                <view class="li_right_txt">
                  <text class="txt-name hui">{{questionItem.create_time}}</text>
                </view>
              </view>
            </block>
          </block>
        </view>
      </block>
    </view>
    <view class="z_pic">
      <image class="z_tou" src="{{question.answerUser.head_img}}"></image>
      <view class="z_pic_right">
        <text class="txt hui">{{question.answerUser.name}}</text>
        <text class="txt hui" style="color: #2ea82b; border: 1px solid #2ea82b;    padding: 2rpx 5rpx;">{{question.answerUser.professional}}</text>
        <text class="txt hui" style="padding: 2rpx 5rpx;color: #80a3ea;border: 1px solid #80a3ea;">LVL{{question.answerUser.level}}</text>
      </view>
    </view>
  </view>
</template>

<script>
  import wepy from 'wepy';
  export default class Index extends wepy.page {
    config = {
      navigationBarTitleText: '问题详情'
    };
    components = {};
    data = {
      ImagesPaths: [],
      indexDetail: '',
      // Collection: '#ccc',
      question: []
    };
    computed = {};
    methods = {
      previewImage(e) {
        let current = e.target.dataset.src;
        wx.previewImage({
          current: current,
          urls: this.data.ImagesPaths
        });
      },
    };
    events = {};
    onLoad(options) {
      this.indexDetail = options.indexDetail
      wx.showLoading({
        title: '加载中',
      })
      wx.request({
        url: `https://wx.yzyy365.com/q/liteq/${options.indexDetail}.html`, //仅为示例，并非真实的接口地址
        data: {},
        header: {
          'content-type': 'application/json' // 默认值
        },
        success: (res) => {
          var imgurl = []
          this.question = res.data
          for (var i = 0; i < this.question.answers.length; i++) {
            if (this.question.answers[i].content_type == 2) {
              imgurl.push(this.question.answers[i].content)
            };
          };
          this.ImagesPaths = imgurl
          wx.hideLoading()
          this.$apply()
        }
      })
    }
      onShareAppMessage() {
          return {
              title: '农技专家',
              desc: '问题详情',
              path: `pages/questionDetail?indexDetail=${this.indexDetail}`
          }
      }
  }
</script>
